# 实验二 使用Open XML解析Word文件
------
## NuGet安装项目的外部引用

点击项目右键》联网查询》搜索openXml 找到对应安装包，点击安装


## OpenXmlElement 类
表示一个基类派生自的 Office Open XML 文档中的所有元素。Elements<T>()枚举仅将具有指定的类型的当前元素的子级
##  实验代码

```python
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Wordprocessing;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace openXmlElement
{
    class Program
    {
        static void Main(string[] args)
        {
            string fileName = @"F:\工作\github\CSharp\test2\科研细则.docx";
            try
            {
                using (WordprocessingDocument wordprocessingDocument =
                WordprocessingDocument.Open(fileName, true))
                {
                    // 获取主体
                    Body body = wordprocessingDocument.MainDocumentPart.Document.Body;

                    // 获取所有元素
                    IEnumerable<DocumentFormat.OpenXml.OpenXmlElement> elements = body.Elements<DocumentFormat.OpenXml.OpenXmlElement>();
                    //遍历元素列表，输出内容
                    foreach (DocumentFormat.OpenXml.OpenXmlElement element in elements)
                    {
                        Console.WriteLine(element.InnerText);
                    }
                    Console.ReadKey();
                }
            }
            catch
            {
                Console.WriteLine("没有找到文件");
                Console.ReadKey();
            }
            
        }
    }
}

```

## 运行结果
```
关于科研管理系统科研成果登记方法细则
 
 为了完善信息科学与工程学院科研管理系统科研成果登记管理，特制定以下细则：
 一、科技成果登记与审核
 1、科研成果（论文、著作、专利、软件著作权）科研处于每年4月上旬，7月上旬，10月上旬，12月中旬由学院集中审核，具体时间会及时发布通知，学院审核通过以后，系统显示“机构通过”。
 2、学院审核统计以后，交于科研处审核。如果科研成果审核通过，系统显示“学校通过”；如果不通过“学校不通过”，请及时按照审核意见重新登记；仍然显示“机构通过”，请耐心等待审核。如果显示“学校不通过”未及时修改的成果将不计算科研工作量
 3、登记时间：
 每年4月上旬之前可登记（上年12月-当前时间）科研成果。
 每年7月上旬之前可登记（3月-当前时间）科研成果。
 每年10月上旬之前可登记（6月-当前时间）科研成果。
 每年12月中旬之前可登记（9月-当前时间）科研成果。
 二、登记注意事项
    1、专利登记：
 （1）专利申请：在名称后添加（申请），并在系统中上传“受理通知书”；例如：一种新型的汽车防盗装置（申请）。（新申请专利则提交盖章的受理通知书复印件）                                                                                                                               
 （2）专利授权：在名称后添加（授权）），并上传“授权证书”首页电子扫描件；例如：一种新型的汽车防盗装置（授权）。注：授权的专利电子扫描件，原则上只认“授权证书”有效，“授权通知书”不予认定。
 （3）如果以前没有登记“申请”的“授权”，请在名称后面添加（申请+授权），并上传“受理通知书”和“授权证书”：例如：一种新型的汽车防盗装置（受理+授权）
 （4）所有的专利成果必须提交复印件2份（季度末统一交到十教10115），必须保证文件清晰，否则不予认定。
 （5）专利登记所有信息必须按照证书填写准确，特别是证书上面的编号：申请号，授权号，公开号，必须填写准确。申请日期、授权日期、公开日期也必须准确。示例如下：
 
 图1 专利登记说明1
 
 图2 专利登记说明2
 
                      图3 登记正确页面图
 软著登记
 （1）软著相关信息请务必准确填写，相关信息参见下图请务必按照专利证书相关信息准确填写，以免影响科研计分。
 （2）系统登记完成后，请提交证书页复印件2份至科研秘书处，由科研秘书统一递交至科研处，复印件作为成果核查与计分依据，务必清晰、准确，不提交和提交不清晰均会影响计分。
 示例图如下：
 
 图3 软件著作登记图示
 
 图4 登记正确图例
 论文成果登记
 在系统科研登记的时，论文登记必须按照期刊的准确信息登记，保证信息登记准确，清楚。
 中文核心及以上的期刊，必须提交原刊，并上传电子扫描文档，以提供给图书馆存档，否则不予认定。一般期刊不用提交原刊，但必须上传电子扫描文档。
 EI，SCI等检索期刊论文必须提供检索报告，检索报报告必须与见刊后6个月内提交，并上传系统。
 普通外文期刊原则上也必须提交原刊。若确实没有，必须保证上传的电子文档，有准确的ISSN号。
 本校第一单位的所有期刊，都只认定第一作者。非本校第一单位ＳＣＩ期刊可以登记校，分数认定按照学校科研管理办法处理。（科研处２０１６年５１号文件）
 （５）论文扫描件：封面，目录，正文，封底；做成一个ＰＤＦ文件，并保证文件清晰明白。每个文件不得超过１０Ｍ。
 　ＥＩ，ＳＣＩ检索期刊必须扫描检索报告上传，每个文件不得超过１０Ｍ。 四、著作版权登记
 教材著作版权系统登记必须按照书籍信息准确登记，保证登记信息准确明白。
 主编，参编人员，每个人参编的字数分配必须明白.否则只认定第一主编。
 教材著作版权，必须提交原件，用于图书馆归档，同时上传电子扫描文档。
 扫描文档包含：封面，版权页，内容简介/序言/前言，目录，封底。整理成一个ＰＤＦ文件，且文件大小不得超过１０Ｍ。
 项目其他登记
 （1）所有的横向，纵向项目也需要在科研管理系统登记，项目来源，经费，日期等信息填写准确，便于学校和学院进行相关的项目需要和查询。
 （2）所有的项目做“预算书”和“预算调整书”时候，一式4份，由学院科研秘书每周统一提交科研处。并发送电子文档給科研秘书。
 六、所有科研成果登记最终以科研处规定通知为准。

```
## 参考
[OpenXmlElement类示例](https://msdn.microsoft.com/zh-cn/library/office/documentformat.openxml.openxmlelement.aspx)